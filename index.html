<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dietitian's Focus Engine</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to bottom right, #ecfdf5, #f0f9ff);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 16px;
    }
    .card {
      max-width: 480px;
      width: 100%;
      background: white;
      padding: 32px;
      border-radius: 20px;
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.08);
      backdrop-filter: blur(12px);
      animation: fadeIn 1.2s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .shimmer {
      position: relative;
      overflow: hidden;
      background: linear-gradient(90deg, #0284c7, #10b981, #0284c7);
      background-size: 200% 200%;
      animation: shimmerMove 4.5s ease-in-out infinite alternate, breathe 4.5s ease-in-out infinite;
    }
    @keyframes shimmerMove {
      from { background-position: 0% 50%; }
      to { background-position: 100% 50%; }
    }
    @keyframes breathe {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    .flare {
      position: absolute;
      inset: 0;
      background: rgba(255,255,255,0.35);
      animation: flare 0.2s ease-out;
    }
    @keyframes flare {
      from { opacity: 0.7; }
      to { opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-gray-800 flex items-center justify-center">
        <span class="mr-2">üçé</span> Dietitian's Focus Engine
      </h1>
      <p class="text-gray-500 mt-1 text-sm">Find the one, most basic health benefit of any food ‚Äî explained clearly.</p>
    </div>

    <label for="foodInput" class="block text-sm font-medium text-gray-700 mb-2">Enter a Food:</label>
    <input id="foodInput" placeholder="e.g., Avocado, Quinoa, Walnuts"
      class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-400 focus:border-emerald-400 mb-6 text-gray-700 text-base" oninput="toggleButton()" />

    <button id="analyzeButton" onclick="generateNutritionFocus()"
      class="shimmer text-white font-semibold py-3 rounded-xl w-full text-lg relative transition-all disabled:opacity-60 disabled:cursor-not-allowed">
      <span id="buttonLabel">Analyze Food</span>
    </button>

    <h2 class="text-lg font-semibold text-gray-800 mt-8 mb-2">Nutritional Focus:</h2>

    <div id="resultBox" class="p-4 rounded-xl bg-emerald-50 border border-emerald-200 text-emerald-800 text-base hidden"></div>
    <div id="errorBox" class="p-4 rounded-xl bg-red-50 border border-red-200 text-red-700 text-base hidden"></div>

    <p class="text-xs text-gray-400 mt-4 text-center">Version: LIVE MODE (connected to Vercel API)</p>
  </div>

  <script>
    const API_URL = "https://focus-engine-api.vercel.app/api/generate";
    const foodInput = document.getElementById("foodInput");
    const analyzeButton = document.getElementById("analyzeButton");
    const buttonLabel = document.getElementById("buttonLabel");
    const resultBox = document.getElementById("resultBox");
    const errorBox = document.getElementById("errorBox");

    function toggleButton() {
      analyzeButton.disabled = !foodInput.value.trim();
    }

    async function generateNutritionFocus() {
      const food = foodInput.value.trim();
      if (!food) return;

      resultBox.classList.add("hidden");
      errorBox.classList.add("hidden");
      buttonLabel.textContent = "Analyzing‚Ä¶";
      analyzeButton.disabled = true;

      // Tiny 200ms ripple flare
      const flare = document.createElement("span");
      flare.className = "flare";
      analyzeButton.appendChild(flare);
      setTimeout(() => flare.remove(), 200);

      try {
        const response = await fetch(`${API_URL}?food=${encodeURIComponent(food)}`);
        const result = await response.json();
        if (result.text) {
          resultBox.textContent = result.text;
          resultBox.classList.remove("hidden");
        } else {
          throw new Error("Empty result");
        }
      } catch (err) {
        errorBox.textContent = "Network Error: Failed to connect to the API.";
        errorBox.classList.remove("hidden");
      } finally {
        buttonLabel.textContent = "Analyze Food";
        analyzeButton.disabled = false;
      }
    }

    window.onload = toggleButton;
  </script>
</body>
</html>
