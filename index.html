<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dietitian's Focus Engine</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color:#f7f7f7; display:flex; justify-content:center; align-items:center; min-height:100vh; margin:0; padding:20px; }
    .container-card { max-width:480px; width:100%; background:white; padding:32px; border-radius:16px; box-shadow:0 10px 25px rgba(0,0,0,0.1); }
    .error-message{ background:#fef2f2; color:#b91c1c; border:1px solid #fca5a5; }
    .success-message{ background:#eff6ff; color:#1e40af; border:1px solid #93c5fd; }
    .hidden{ display:none !important; }
  </style>
</head>
<body>
  <div class="container-card">
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-gray-800 flex items-center justify-center">
        <span class="mr-2">üçé</span> Dietitian's Focus Engine
      </h1>
      <p class="text-gray-500 mt-1 text-sm">Find the one, most basic health benefit of any food, explained clearly.</p>
    </div>

    <label for="foodInput" class="block text-sm font-medium text-gray-700 mb-2">Enter a Food:</label>
    <input type="text" id="foodInput" placeholder="e.g., Avocado, Quinoa, Walnuts" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 mb-6" oninput="toggleButton()" />

    <button id="analyzeButton" onclick="generateNutritionFocus()" class="w-full bg-blue-600 text-white p-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-150 disabled:bg-blue-300 flex items-center justify-center" disabled>
      <svg id="loadingSpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <span id="analyzeLabel">Analyze Food</span>
    </button>

    <h2 class="text-lg font-semibold text-gray-800 mt-8 mb-2">Nutritional Focus:</h2>

    <div id="resultBox" class="min-h-16 p-4 rounded-lg success-message text-sm mb-2 hidden"></div>

    <div id="errorBox" class="min-h-16 p-4 rounded-lg error-message text-sm hidden"></div>
    
    <p class="text-xs text-gray-400 mt-2 text-center">Version: MOCK MODE (no API)</p>
  </div>

  <script>
    const foodInput = document.getElementById('foodInput');
    const analyzeButton = document.getElementById('analyzeButton');
    const resultBox = document.getElementById('resultBox');
    const errorBox = document.getElementById('errorBox');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const analyzeLabel = document.getElementById('analyzeLabel');

    function toggleButton() {
      analyzeButton.disabled = foodInput.value.trim() === '';
    }

    // Simple mock "analysis" function: returns 2-sentence response following your required structure.
    function mockAnalyze(food) {
      // Basic mapping for a few known foods; otherwise a safe default.
      const map = {
        avocado: {
          nutrient: "monounsaturated fat",
          functions: "heart health and steady energy",
          why: "It helps lower bad cholesterol while providing lasting satiety, supporting better weight control and long-term cardiovascular health"
        },
        quinoa: {
          nutrient: "complete plant protein",
          functions: "muscle repair and balanced blood sugar",
          why: "It provides all essential amino acids needed for rebuilding tissues and helps stabilize energy levels between meals, supporting sustained activity and metabolic health"
        },
        walnuts: {
          nutrient: "omega-3 fatty acids (ALA)",
          functions: "brain and heart support",
          why: "These fats support healthy brain function and reduce inflammation, helping cognitive performance and long-term heart health"
        },
      };

      const key = food.toLowerCase().trim();
      const entry = map[key] || {
        nutrient: "a concentrated set of beneficial nutrients",
        functions: "important bodily functions",
        why: "These nutrients contribute to better function and well-being when included regularly in a balanced diet"
      };

      // Build the two-sentence response exactly as required
      const sentence1 = `The main health benefit of ${food}, above all others, is their role as an exceptional source of ${entry.nutrient}, which is crucial for ${entry.functions}.`;
      const sentence2 = `This ${entry.nutrient} actively helps to ${entry.why.split(',')[0]}, while supporting ${entry.why.split(' and ')[1] || 'overall health'} and promoting long-term well-being!`;

      return `${sentence1} ${sentence2}`;
    }

    async function generateNutritionFocus() {
      const foodName = foodInput.value.trim();
      if (!foodName) return;

      // UI: clear and show loading
      resultBox.classList.add('hidden');
      errorBox.classList.add('hidden');
      resultBox.textContent = '';
      errorBox.textContent = '';

      analyzeButton.disabled = true;
      loadingSpinner.classList.remove('hidden');
      analyzeLabel.textContent = 'Analyzing...';

      try {
        // Simulate short delay as if contacting an API
        await new Promise(resolve => setTimeout(resolve, 700));

        const text = mockAnalyze(foodName);

        // Display result
        resultBox.textContent = text;
        resultBox.classList.remove('hidden');
      } catch (err) {
        errorBox.textContent = 'Unexpected error: ' + (err.message || err);
        errorBox.classList.remove('hidden');
      } finally {
        analyzeLabel.textContent = 'Analyze Food';
        loadingSpinner.classList.add('hidden');
        toggleButton();
      }
    }

    // Allow Enter to submit
    foodInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !analyzeButton.disabled) {
        generateNutritionFocus();
      }
    });

    window.onload = toggleButton;
  </script>
</body>
</html>
